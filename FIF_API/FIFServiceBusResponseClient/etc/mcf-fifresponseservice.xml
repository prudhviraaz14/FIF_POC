<?xml version="1.0" encoding="UTF-8"?>
<!--
    ******************************************************************************
    COBS 1.24 Application Configuration File
    
    IMPORTANT NOTICE: This file is automatically generated. Any change 
    applied to this file has to be reported to IT Change Management (OSX)
    
    WICHTIGER HINWEIS: Diese Datei wird automatisch erzeugt. Jede Aenderung 
    an dieser Datei muss berichtet werden an IT Change Management (OSX)
    
    Environment     : kt
    Config          : 303
    
    Product         : FIF
    Build           : 136.00
    
    Package         : pkgbksat 
    Application     : FIF
    Stream          : INF
    Instance        : kt_bks@pkgfifgt/ccb/ccb20/kt/pkgfifgt/aaw/kt/bks/PRD/apps/BKS/etc/mcf-bksservice.xml
    
    Language        : XML
    
    Config File     : mcf-fifresponseservice.xml
    Config Date     : Thu Sep  6 17:50:34 2007
    Config Autor    : Rusbe Makuie
    
    (c)Copyright 1999-2007 Arcor AG & Co. KG
    ******************************************************************************
-->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jms="http://www.springframework.org/schema/jms"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:util="http://www.springframework.org/schema/util" 
    xmlns:context="http://www.springframework.org/schema/context" 
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/jms http://www.springframework.org/schema/jms/spring-jms-2.5.xsd
                        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
                        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd                       
                        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
                        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:responsePlaceHolder.properties"/>
        <property name="ignoreUnresolvablePlaceholders" value="true"/>
    </bean>
        
    <import resource="classpath:/mcf2/mcf2-nodb-applicationContext.xml"/>
    <!-- MCF2 webservice extension: -->
    <import resource="classpath:/mcf2/ws/wsApplicationContext.xml"/>
    
    <!-- Queue configuration -->
    <bean id="sbus-default-listener" class="net.arcor.mcf2.listener.MCFMessageListenerContainer">
        <property name="connectionFactory" ref="connectionFactory"/>
        <property name="destinationName" value="${mcf.queue.listen}"  />
        <property name="concurrentConsumers" value="${ConcurrentConsumers}" />
        <property name="transactionManager" ref="jmsTransactionManager" />
        <property name="messageListener" ref="mcfMessageListener" />
        <property name="messageSelector" value="SBUS_Servicename = '/EmailUtility-001/ValidateEmail' or
	        JMSType = 'Response' and (             
	            SBUS_Servicename = 'aktualisiereEueKundendatenService' or
	            SBUS_Servicename = 'starteEingehendeRufnummerPortierungService' or
	            SBUS_Servicename = 'setTriggerService' or
	            SBUS_Servicename = 'startPreclearedFixedLineOrderService' and SBUS_AsyncRequest = 'true' or
	            SBUS_Servicename = 'fatalServiceResponse' and ( 
	            SBUS_Endpunkt = 'CUSTWGVF' or
	            SBUS_Endpunkt = 'CSERVICE' or
	            SBUS_Endpunkt = 'BKS' and SBUS_AsyncRequest = 'true' or
	            SBUS_Endpunkt = 'COM'))"/>
    </bean> 
    
    <!-- Spezielles Logging durchfuehren -->
    
    <bean id="loggingAspect"
        class="net.arcor.mcf2.supplemental.LoggingAspect"/>
    <aop:config proxy-target-class="true">
        <aop:aspect ref="loggingAspect">
            <aop:after-throwing
                pointcut="execution(* net.arcor.mcf2.listener.MCFMessageListenerAdapter.onMessage(..))"
                method="logException"
                throwing="throwable"/>
        </aop:aspect>
    </aop:config>
    

    <!-- Die fuer diesen Adapter definierten Services -->
    <bean id="serviceRegistryEndpoint"
        class="net.arcor.mcf2.model.ServiceRegistryEndpoint">
        <property name="serviceConfigs">
            <list>
                <ref bean="starteEingehendeRufnummerPortierungServiceConfig"/>
                <ref bean="aktualisiereEueKundendatenServiceConfig"/>
                <ref bean="setTriggerServiceConfig"/>
                <ref bean="startPreclearedFixedLineOrderServiceConfig"/>
                <ref bean="fatalServiceResponseConfig"/>
            </list>
        </property>
    </bean>
    
    <bean id="synchronousResponseHandler"
        class="net.arcor.fif.servicehandler.SynchronousFifResponseHandler"/>
    
    
    <bean id="startPreclearedFixedLineOrderServiceConfig"
        class="net.arcor.mcf2.model.ServiceConfigXml">
        <constructor-arg value="startPreclearedFixedLineOrderService,001"/>
        <constructor-arg value="EPSM-COM-001.xsd"/>
        <constructor-arg value="net.arcor.com.epsm_com_001"/>
        <constructor-arg  ref="synchronousResponseHandler"/>
    </bean>
    
    <bean id="aktualisiereEueKundendatenServiceConfig"
        class="net.arcor.mcf2.model.ServiceConfigXml">
        <constructor-arg value="aktualisiereEueKundendatenService,001"/>
        <constructor-arg value="EPSM-CFM-WHSEUE-001.xsd"/>
        <constructor-arg value="net.arcor.cfm.epsm_cfm_whseue_001"/>
        <constructor-arg  ref="synchronousResponseHandler"/>
    </bean>
    
    <bean id="setTriggerServiceConfig"
        class="net.arcor.mcf2.model.ServiceConfigXml">
        <constructor-arg value="setTriggerService,001"/>
        <constructor-arg value="EPSM-CUSTWG-WHSVF-001.xsd"/>
        <constructor-arg value="net.arcor.custwg.epsm_custwg_whsvf_001"/>
        <constructor-arg  ref="synchronousResponseHandler"/>
    </bean>
    
    <bean id="fatalServiceResponseConfig"
        class="net.arcor.mcf2.model.ServiceConfigXml">
        <constructor-arg value="fatalServiceResponse,001"/>
        <constructor-arg value="EPSM-SBUS-001.xsd"/>
        <constructor-arg value="net.arcor.sbus.epsm_sbus_001"/>
        <constructor-arg  ref="synchronousResponseHandler"/>
    </bean>
    
    <bean id="starteEingehendeRufnummerPortierungServiceConfig"
        class="net.arcor.mcf2.model.ServiceConfigXml">
        <constructor-arg value="starteEingehendeRufnummerPortierungService,001"/>
        <constructor-arg value="EPSM-AIP-001.xsd"/>
        <constructor-arg value="net.arcor.aip.epsm_aip_001"/>
        <constructor-arg  ref="synchronousResponseHandler"/>
    </bean> 
    
    <bean id="soapValidateEmail"
        class="net.arcor.fif.servicehandler.ValidateEmailServiceImpl">
    </bean>
        
	<!-- SOAP:FAULT Handler-->
	<bean id="faultResponseHandler" class="net.arcor.fif.servicehandler.FaultResponseHandlerServiceImpl"
		scope="prototype" />

	<!-- Erweiterung des MCF um SOAP:FAULT richtig behandeln zu kÃ¶nnen -->
	<bean id="mcf.endpointMapping" class="com.vodafone.mcf2.ws.addon.EndpointMapping">
		<property name="defaultEndpoint">
			<bean
				class="com.vodafone.mcf2.ws.tools.UnknownSoapActionFallbackServiceImpl" />
		</property>
	</bean>	
    
</beans>
